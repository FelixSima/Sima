function calplata(){var totalvalue=parseInt(document.getElementById("tbi_total").value);var dobanda;var perioada;var comision;var valasig;if(totalvalue>=100&&totalvalue<=2e3){dobanda=0;perioada=4;comision=0;valasig=0}else if(totalvalue>=2001&&totalvalue<=4e3){dobanda=.29;perioada=parseInt(document.getElementById("tbi_nr_rate").value);comision=95;valasig=.002}else if(totalvalue>=4001&&totalvalue<=1e4){dobanda=.24;perioada=parseInt(document.getElementById("tbi_nr_rate").value);comision=95;valasig=.002}else if(totalvalue>=100001&&totalvalue<=6e4){dobanda=.18;perioada=parseInt(document.getElementById("tbi_nr_rate").value);comision=95;valasig=.002}var valasigurare=valasig*(totalvalue+comision)*perioada;var principal=totalvalue+comision+valasigurare;var CalculateInterest=dobanda/12;var calculatedPayments=perioada;var x=Math.pow(1+CalculateInterest,calculatedPayments);var monthly=principal*x*CalculateInterest/(x-1);var monthlyPayment=monthly.toFixed(2);var interest=0;var dueEndOrBeginning=0;var futureValue=0;var paymentsPerYear=perioada;if(totalvalue<2001){var presentValue=totalvalue;var paymentAmount=-((totalvalue+comision)/4)}else{var presentValue=totalvalue+valasigurare;var paymentAmount=monthlyPayment*-1}var FINANCIAL_MAX_ITERATIONS=128;var FINANCIAL_PRECISION=1e-7;var y,y0,y1,x0,x1=0,f=0,i=0;var rate=interest;if(Math.abs(rate)<FINANCIAL_PRECISION){y=presentValue*(1+paymentsPerYear*rate)+paymentAmount*(1+rate*dueEndOrBeginning)*paymentsPerYear+futureValue}else{f=Math.exp(paymentsPerYear*Math.log(1+rate));y=presentValue*f+paymentAmount*(1/rate+dueEndOrBeginning)*(f-1)+futureValue}y0=presentValue+paymentAmount*paymentsPerYear+futureValue;y1=presentValue*f+paymentAmount*(1/rate+dueEndOrBeginning)*(f-1)+futureValue;i=x0=0;x1=rate;while(Math.abs(y0-y1)>FINANCIAL_PRECISION&&i<FINANCIAL_MAX_ITERATIONS){rate=(y1*x0-y0*x1)/(y1-y0);x0=x1;x1=rate;if(Math.abs(rate)<FINANCIAL_PRECISION){y=presentValue*(1+paymentsPerYear*rate)+paymentAmount*(1+rate*dueEndOrBeginning)*paymentsPerYear+futureValue}else{f=Math.exp(paymentsPerYear*Math.log(1+rate));y=presentValue*f+paymentAmount*(1/rate+dueEndOrBeginning)*(f-1)+futureValue}y0=y1;y1=y;++i}var dae=(((1+rate)**12-1)*100).toFixed(2);document.getElementById("insurance").innerText=valasigurare.toFixed(2);if(totalvalue<2001){document.getElementById("tbi_month_rate").innerText=(totalvalue+0)/4;document.getElementById("total").innerText=(totalvalue+40).toFixed(2)}else{document.getElementById("tbi_month_rate").innerText=monthlyPayment;document.getElementById("total").innerText=(monthlyPayment*perioada).toFixed(2)}}function tbiSlider(){var sliderTbiTotal=document.getElementById("tbi_total");var sliderRatesNr=document.getElementById("tbi_nr_rate");var totalOutput=document.getElementById("tbi_total_info");var ratesNrOutput=document.getElementById("tbi_nr_rate_info");sliderTbiTotal.oninput=function(){totalOutput.innerHTML=this.value;percent=totalOutput.innerHTML/100;this.style.background=`linear-gradient(to right, #ffb867 0%, #ffb867 ${percent}%, #fff ${percent}%, white 100%)`;calplata()};sliderRatesNr.oninput=function(e){ratesNrOutput.innerHTML=this.value;maxVal=document.getElementById("tbi_nr_rate").max;val=ratesNrOutput.innerHTML;percent=val/maxVal*100-5;this.style.background=`linear-gradient(to right, #ffb867 0%, #ffb867 ${percent}%, #fff ${percent}%, white 100%)`;calplata()}}const tbi_calc=document.getElementById("tbi-rate-calculator");if(tbi_calc){calplata();tbiSlider()}