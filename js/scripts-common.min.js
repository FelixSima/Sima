var success_message='<div class="alert alert-success success_message"><i class="fa fa-check"></i> <strong>'+_("Informatiile au fost salvate")+"</strong></div>";var loading_message='<h2 class="loading_message"><i class="fa fa-spinner fa-spin"></i> '+_("Se incarca...")+"</h2>";var is_touch="ontouchstart"in window||navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>0;var current_state="";$(window).on("load",function(){if($("#products-list .product-box").length>1){$("#products-list .product-box.next-page").css("height",$("#products-list .product-box").height())}});if(typeof $!="undefined"){$(document).ready(function(){executeOnDocumentReady()})}function initWindowResize(){var resize_state=getViewportSize();if(current_state!=resize_state){current_state=resize_state;executeOnViewportChange(current_state)}autoResizeElements()}function initSearchSuggest(){if(isID("search-box")&&(typeof search_frontend_provider=="undefined"||search_frontend_provider=="")){if(typeof new_age_search_suggest!="undefined"&&new_age_search_suggest){$("#search-box").bind("input paste",function(e){delay(function(){var term=$("#search-box").val();if(term.length>=3){$("#search_form .fa-spinner").removeClass(bs4?"d-none":"hidden");$("#search_form .fa-search").addClass(bs4?"d-none":"hidden");$("#search-suggest").load("/ajax/search_history?output=html&q="+encodeURIComponent(term),function(response,status,xhr){if(response!=""){$("#search-suggest").removeClass(bs4?"d-none":"hidden")}else{$("#search-suggest").addClass(bs4?"d-none":"hidden")}if(status=="error"){alert(_("Eroare la actualizare (%1), incercati din nou in cateva secunde",status+": "+xhr.status))}$("#search_form .fa-spinner").addClass(bs4?"d-none":"hidden");$("#search_form .fa-search").removeClass(bs4?"d-none":"hidden")})}else{$("#search-suggest").html("").addClass(bs4?"d-none":"hidden")}},typeof search_suggest_timeout=="undefined"?500:search_suggest_timeout)});$("body").click(function(){$("#search-suggest").html("").addClass(bs4?"d-none":"hidden")});$("#search_form").click(function(event){event.stopPropagation()});var selected_element=0;$("#search-box").keyup(function(ev){if(isID("search-suggest")){if($("#search-suggest").hasClass(bs4?"d-none":"hidden")){return false}if(ev.keyCode==38||ev.keyCode==40){var direction=0;if(ev.keyCode==38){direction=-1}else if(ev.keyCode==40){direction=+1}if(direction!=0){var result=$("#srs_"+(selected_element+direction));if(result.length){selected_element=selected_element+direction;$("#search-suggest li.hover").removeClass("hover");result.addClass("hover")}}ev.preventDefault()}else if(ev.keyCode==13){var result=$("#srs_"+selected_element);if(result.length){searchSuggestResultClick(result,ev)}ev.preventDefault()}else if(ev.keyCode==27){$("#search-suggest").html("").addClass(bs4?"d-none":"hidden");selected_element=0}return false}})}else{$("#search-box").typeahead({onSelect:function(item){if(item.value=="#"||item.value=="undefined"){if(typeof search_all_products_page_alias!=="undefined"&&typeof filters_search_token!=="undefined"){window.location="/"+search_all_products_page_alias+"/filtre/"+filters_search_token+encodeURIComponent($("#search-box").val()).replace(/%20/g,"+")+"/?search_sort=relevance%7Cascending"}else{window.location="/search/"+encodeURIComponent($("#search-box").val()).replace(/%20/g,"+")}}else{window.location=item.value}},highlighter:function(item){return item},grepper:function(item){return item},sorter:function(item){return item},ajax:{url:"/ajax/search_history?output=json&show_keys=true",timeout:typeof search_suggest_timeout=="undefined"?500:search_suggest_timeout,triggerLength:3,method:"get",grepper:false,sorter:false,items:10,preDispatch:function(query){$("#search_form .fa-spinner").removeClass(bs4?"d-none":"hidden");$("#search_form .fa-search").addClass(bs4?"d-none":"hidden");return{search:query}},preProcess:function(data){$("#search_form .fa-spinner").addClass(bs4?"d-none":"hidden");$("#search_form .fa-search").removeClass(bs4?"d-none":"hidden");if(data.success===false){return false}else{var return_obj=[];if(data.length>0){return_obj.push({id:"#",name:'<span class="small ignored">'+_("Cauta dupa:")+"</span>"+'<br><em class="big">'+$("#search-box").val()+"</em>"});$.each(data,function(key,product){var row_html='<div class="product row">'+'<div class="image '+product.availability_unformatted+" "+(bs4?"col-2":"col-xs-2")+'">'+'<img src="'+product.image+'" alt="" style="max-width: 35px;">'+"</div>"+'<div class="col-xs-10">'+'<div class="name">'+product.name+' <span class="pid">#'+product.id+"</span></div>"+'<div class="price '+(bs4?"float-left":"pull-left")+' ignored">'+product.price+"</div>"+'<div class="'+(bs4?"float-right":"pull-right")+'">'+'<div class="rating small text-right ignored">'+product.rating_bar+"</div>"+'<div class="availability small '+product.availability_unformatted+' text-right ignored">'+product.availability+"</div>"+"</div>"+"</div>"+"</div>";return_obj.push({id:product.url,name:row_html})})}return return_obj}}}})}}}function initProductClick(){$(document).on("click","a[data-ecproduct=true], a[data-url-img]",function(e){let url_img=$(this).data("url-img");let product_url=$(this).attr("href");if(product_url&&url_img){product_url=addUrlParam(product_url,"img="+url_img)}if(typeof ecProductClick=="function"&&(typeof ga!="undefined"||typeof dataLayer!="undefined")){let product_id=$(this).data("ecpid");let listing_variant=$(this).data("ecvariant");let idx=product_id+(listing_variant?"_"+listing_variant:"");if(ecListedProducts[idx]&&typeof ecListedProducts[idx].url!="undefined"){if(e.metaKey||e.ctrlKey||e.which==2){$(this).attr("href",product_url);ecProductClick(product_id,listing_variant,url_img,false)}else{e.preventDefault();ecProductClick(product_id,listing_variant,url_img,true)}}else{console.error("ecListedProducts not loaded for #"+product_id)}}else if(url_img&&product_url){if(e.metaKey||e.ctrlKey||e.which==2){$(this).attr("href",product_url)}else{e.preventDefault();document.location=product_url}}else{console.error("GA or ecProductClick or url_img not loaded")}})}function initPriceSlider(){if(isID("price-slider")){$("#price-slider").slider();$("#price-slider").on("slide slideStop",function(slideEvt){$("#min-price").val(slideEvt.value[0]);$("#max-price").val(slideEvt.value[1]);if(isID("min-price-info")&&isID("max-price-info")){$("#min-price-info").text(slideEvt.value[0]);$("#max-price-info").text(slideEvt.value[1])}});$("#min-price, #max-price").on("change",function(event){var sMinPrice=parseFloat($("#min-price").val());var sMaxPrice=parseFloat($("#max-price").val());if(sMinPrice&&sMaxPrice){if(event.type=="change"){if($(this).prop("id")=="min-price"&&sMinPrice>sMaxPrice){sMinPrice=sMaxPrice;$("#min-price").val(sMinPrice)}else if($(this).prop("id")=="max-price"&&sMaxPrice<sMinPrice){sMaxPrice=sMinPrice;$("#max-price").val(sMaxPrice)}}$("#price-slider").slider("setValue",[sMinPrice,sMaxPrice])}})}}function initTitleFocus(){if(isID("title-alt")){var alt_title=$("#title-alt").val();if(alt_title){var title=$(document).find("title");var original_title=title.text();if(original_title){$(window).on("blur",function(){title.text(alt_title)}).on("focus",function(){title.text(original_title)})}}}}function initGalleryCarousel(){if(isID("gallery-carousel")){$("#gallery-carousel").on("slid.bs.carousel",function(){var imgID=$("#gallery-carousel .full-img .item.active").attr("data-slide-id");var productID=$("#gallery-carousel").attr("data-product_id");var enumID=$("#gallery-carousel .full-img .item.active").attr("data-slide-enum_id");var enumValue=$("#gallery-carousel .full-img .item.active").attr("data-slide-enum_value");var charID=$("#gallery-carousel .full-img .item.active").attr("data-slide-char_id");if(typeof imgID!==typeof undefined&&imgID!==false){if(!isID("modal-container")){history.replaceState(null,null,"?img="+imgID)}if(isID("product_variant")){$("#product_variant").html(enumValue);$("#req-"+productID+"_"+charID).val(enumID)}}})}}let delay=function(){var timer=0;return function(callback,ms){clearTimeout(timer);timer=setTimeout(callback,ms)}}();if(typeof _!="function"){function _(string){var translated_string=string;if(typeof lang!=="undefined"&&lang[string]){translated_string=lang[string]}if(arguments.length>1){for(var i=1;i<arguments.length;i++){var param="%"+i;translated_string=translated_string.replace(param,arguments[i])}}return translated_string}}function autoResizeElements(){setTimeout(function(){$("#gallery-carousel .thumbnail-img").height($("#gallery-carousel .full-img").height())},250);$(".product-box.next-page").css("height",$(".product-box").height())}function searchSuggestResultClick($this,$event){var furl=$($this).data("href");if(furl){if($event.metaKey||$event.ctrlKey||$event.which==2){window.open(furl,"_blank")}else{window.location=furl}}}function setCookie(key,value,expire_days){return $.cookie(key,value,{expires:expire_days,path:"/",domain:cookie_domain,secure:is_ssl})}function getPopoverContent(target_selector){var html=$(target_selector).html();$(".popover-tracker").html("");return html}function scrollToElement(destination,top){if($('a[href="'+destination+'"][data-toggle="tab"]').length&&$('#tabs a[href="'+destination+'"]').length){$("#tabs a[href="+destination+"]").click()}if(typeof top=="undefined"){top=typeof scroll_top_height=="undefined"?55:scroll_top_height}if($(destination).length>0){var stop=$(destination+":first").offset().top-top;$("body,html").animate({scrollTop:stop},300)}return false}jQuery.fn.scrollTo=function(elem,speed){$(this).animate({scrollTop:$(this).scrollTop()-$(this).offset().top+$(elem).offset().top},speed==undefined?500:speed);return this};function showProductImage(iid,selector){if(iid&&selector){var position=$(selector+" [data-slide-id="+iid+"]").index();$(selector).carousel(position)}}function openContactForm(department,product_id,source,wishlist_id){constructModal("/asistenta-clienti/?department="+department+"&product_id="+product_id+"&source="+source+"&wishlist_id="+wishlist_id,_("Formular contact"),null,"")}function addToCart(pid,return_url,extra_get){if(typeof return_url=="undefined"){return_url=""}if(typeof extra_get=="undefined"){extra_get=""}constructModal("/ajax/shopping/cartmodal?pid="+pid+extra_get+"&return_url="+encodeURIComponent(return_url),_("Previzualizare produs"),"",false)}function applyPriceFilter(template_url){window.location="/"+$.sprintf(template_url,$("#min-price").val(),$("#max-price").val());return false}function ajaxFormInit(source_selector,target_selector){$(source_selector+" form").ajaxForm({target:target_selector,beforeSubmit:function(arr,$form,options){var is_valid=validateForm($($form).attr("data-validate"));if(is_valid){$(target_selector).html(loading_message)}else{return false}},success:function(){}});if(typeof customAnimatedLabel()==="function"){customAnimatedLabel()}}function constructModal(url,title,subtitle,buttons,size,addClass){if(current_state=="xs"&&$(".navbar-full-xs").length&&$(".navbar-full-xs").hasClass("in")){$(".navbar-full-xs").removeClass("in")}if(typeof title=="undefined"||title===null){title=_("Detalii")}if(typeof subtitle=="undefined"||subtitle===null){subtitle=_("(Apasati ESC pentru a inchide)")}if(typeof buttons=="undefined"||buttons===null){buttons=[{text:_("Inchide"),style:"danger",close:true}]}else if(buttons.length==0){buttons=false}if(typeof size=="undefined"||size===null){size="lg"}if(typeof addClass=="undefined"||addClass===null||addClass===false||addClass.substring(0,9)!="modal_cc_"){addClass=""}url=addUrlParam(url,"is_modal=1");eModal.ajax({url:url,size:size,title:title,subtitle:subtitle,buttons:buttons,dataType:"html",addClass:addClass})}function destroyModal(){if(isID("main-modal")){eModal.close()}}function modalInit(){if(typeof customAnimatedLabel==="function"){customAnimatedLabel()}initGalleryCarousel();$("#modal-container form").ajaxForm({target:"#main-modal-body",beforeSubmit:function(arr,$form,options){var is_valid=validateForm($($form).attr("data-validate"));if(is_valid){$(".modal-body").html(loading_message)}else{return false}},success:function(){}});$('.modal [data-toggle="tooltip"]').tooltip();setTimeout(function(){$("#modal-container #gallery-carousel .thumbnail-img").height($("#gallery-carousel .full-img").height())},50);if(is_touch){$(".carousel").swiperight(function(){$(this).carousel("prev")});$(".carousel").swipeleft(function(){$(this).carousel("next")})}else{if(isID("modal-carousel")){$(document).bind("keyup",function(e){if(e.which==39){$("#modal-carousel").carousel("next")}else if(e.which==37){$("#modal-carousel").carousel("prev")}})}}$("#main-modal").on("hidden.bs.modal",function(){$(this).find(".modal-dialog").removeClassRegex(/^modal_cc_/)})}function inputValid(id,message,rule,value){var error=checkValid(id,message,rule,value);var error_msg_id="err_"+id;var selector;if(rule=="radio"){selector="input:radio[name='"+id+"']:first"}else if(rule=="checkbox"){selector="input:checkbox[name='"+id+"']:first"}else{selector="#"+id}if(error!=""){if(!isID(error_msg_id)){$(selector).parents(".form-group").addClass("has-error");var display_msg='<small class="has-error" id="'+error_msg_id+'">'+error+"</small>";if($(selector).parent(".input-group").length){$(selector).parent(".input-group").after(display_msg)}else{$(selector).after(display_msg)}}return false}else{$("#"+error_msg_id).remove();$(selector).parents(".form-group").removeClass("has-error");return true}}function validateForm(which){var err=[];var has_error=false;switch(which){case"newsletter_content":err[err.length]=inputValid("news_email",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("news_email",_("Adresa de email introdusa nu este valida"),"email")}break;case"newsletter_subscribe":err[err.length]=inputValid("news_name",_("Completati numele"),"required");err[err.length]=inputValid("news_email",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("news_email",_("Adresa de email introdusa nu este valida"),"email")}break;case"newsletter_subscribe_popup":err[err.length]=inputValid("news_name_pop",_("Completati numele"),"required");err[err.length]=inputValid("news_email_pop",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("news_email_pop",_("Adresa de email introdusa nu este valida"),"email")}break;case"price_alert":err[err.length]=inputValid("prformname",_("Completati numele"),"required");err[err.length]=inputValid("prformemail",_("Completati adresa de email"),"required");err[err.length]=inputValid("prformprice",_("Completati pretul dorit"),"required");if(err[err.length-1]){err[err.length]=inputValid("prformemail",_("Adresa de email introdusa nu este valida"),"email")}break;case"contact_form":err[err.length]=inputValid("cformname",_("Completati numele"),"required");err[err.length]=inputValid("cformemail",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("cformemail",_("Adresa de email introdusa nu este valida"),"email")}if(isID("cformtelephone")){err[err.length]=inputValid("cformtelephone",_("Completati numarul de telefon"),"required");if(err[err.length-1]&&$(".required_valid_telephone").length>0){err[err.length]=inputValid("cformtelephone",_("Numarul de telefon nu este valid"),"telephone")}}if(isID("bcname")){err[err.length]=inputValid("bcname",_("Completati numele beneficiarului"),"required")}if(!$("#cformiban").hasClass("not-req")){err[err.length]=inputValid("cformiban",_("Completati IBAN-ul"),"required")}if(!$("#cformorderid").hasClass("not-req")){err[err.length]=inputValid("cformorderid",_("Completati numarul de comanda sau factura"),"required")}err[err.length]=inputValid("cformproductid",_("Completati codul produsului"),"required");err[err.length]=inputValid("cformquantity",_("Completati cantitatea"),"required");err[err.length]=inputValid("cformmessage",_("Completati mesajul dvs"),"required");err[err.length]=inputValid("product_url",_("Completati detaliile despre produsul dorit"),"required");break;case"stock_alert":err[err.length]=inputValid("sformname",_("Completati numele"),"required");err[err.length]=inputValid("sformemail",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("sformemail",_("Adresa de email introdusa nu este valida"),"email")}$("#stock_alert .main-enums select").each(function(){if($(this).attr("name").indexOf("req-")!=-1){if(!$(this).val()){has_error=true}}});if(has_error){$("#stock_alert .main-enums").addClass("has-error");if(!isID("err-main-enums-stock-alert-stock-alert")){$("#stock_alert .main-enums select:last").after('<small class="has-error" id="err-main-enums-stock-alert">'+_("* Te rugam sa alegi variantele dorite ale produsului")+"</small>")}return false}else{$("#stock_alert .main-enums").removeClass("has-error");$("#err-main-enums-stock-alert").remove()}break;case"quick_order":err[err.length]=inputValid("cformname",_("Completati numele"),"required");err[err.length]=inputValid("cformemail",_("Completati adresa de email"),"required");if(isID("cforstate")){err[err.length]=inputValid("cforstate",_("Completati judetul"),"required")}if(isID("cforcity")){err[err.length]=inputValid("cforcity",_("Completati localitatea"),"required")}if(isID("cforaddress")){err[err.length]=inputValid("cforaddress",_("Completati adresa"),"required")}if(isID("location")){err[err.length]=inputValid("location",_("Completati localitatea"),"required")}if(err[err.length-1]){err[err.length]=inputValid("cformemail",_("Adresa de email introdusa nu este valida"),"email")}if(isID("cformtelephone")){err[err.length]=inputValid("cformtelephone",_("Completati numarul de telefon."),"required")}if(isID("quick_order_agree")){err[err.length]=inputValid("quick_order_agree",_("Pentru a trimite comanda trebuie sa fiti de acord cu conditiile de utilizare."),"checkbox")}$("#quick_order .main-enums select").each(function(){if($(this).attr("id").indexOf("qreq-")!=-1){if(!$(this).val()){has_error=true}}});if(has_error){$("#quick_order .main-enums").addClass("has-error");if(!isID("err-main-enums-quick-order")){$("#quick_order .main-enums select:last").after('<small class="has-error" id="err-main-enums-quick-order">'+_("* Te rugam sa alegi variantele dorite ale produsului")+"</small>")}return false}else{$("#quick_order .main-enums").removeClass("has-error");$("#err-main-enums-quick-order").remove()}break;case"sendtofriend":err[err.length]=inputValid("sendformname1",_("Completati numele"),"required");err[err.length]=inputValid("sendformmail1",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("sendformmail1",_("Adresa de email introdusa nu este valida"),"email")}err[err.length]=inputValid("sendformmail2",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("sendformmail2",_("Adresa de email introdusa nu este valida"),"email_multiple")}err[err.length]=inputValid("sendformmessage",_("Completati mesajul dvs"),"required");err[err.length]=inputValid("captcha",_("Introduceti codul de validare din imagine"),"required");break;case"write_comment":err[err.length]=inputValid("customer_name",_("Completati numele"),"required");err[err.length]=inputValid("customer_email",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("customer_email",_("Adresa de email introdusa nu este valida"),"email")}if(isID("required_product_rating")){err[err.length]=inputValid("rating",_("Alegeti o nota pentru produs"),"radio")}err[err.length]=inputValid("captcha",_("Introduceti codul de validare"),"required");break;case"site_feedback":err[err.length]=inputValid("sfmessage",_("Completati mesajul dvs"),"required");break;case"send_wishlist":err[err.length]=inputValid("swname",_("Completati numele"),"required");err[err.length]=inputValid("swemail1",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("swemail1",_("Adresa de email introdusa nu este valida"),"email")}err[err.length]=inputValid("swemail2",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("swemail2",_("Adresa de email introdusa nu este valida"),"email")}err[err.length]=inputValid("swmessage",_("Completati mesajul dvs"),"required");err[err.length]=inputValid("captcha",_("Introduceti codul de validare din imagine"),"required");break;case"add_wishlist":err[err.length]=inputValid("wishlist_name",_("Completati numele wishlist-ului"),"required");err[err.length]=inputValid("customer_name",_("Completati numele dvs."),"required");err[err.length]=inputValid("email",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("email",_("Adresa de email introdusa nu este valida"),"email")}break;case"add_new_wishlist":err[err.length]=inputValid("wishlist_name",_("Completati numele wishlist-ului"),"required");break;case"product_rating":err[err.length]=inputValid("customer_name",_("Completati numele"),"required");err[err.length]=inputValid("customer_email",_("Completati adresa de email"),"required");if(err[err.length-1]){err[err.length]=inputValid("customer_email",_("Adresa de email introdusa nu este valida"),"email")}err[err.length]=inputValid("rating",_("Alegeti o nota pentru produs"),"radio");break;default:break}for(var i=0;i<err.length;i++){if(!err[i]){if(which!="newsletter_subscribe_popup"){scrollToElement(".has-error")}return false}}return true}function showNews(validity,title,subtitle,addClass){if(typeof validity=="undefined"){validity=3}if(typeof title=="undefined"){title=_("Aboneaza-te la newsletter")}if(typeof subtitle=="undefined"){subtitle=""}if(typeof addClass=="undefined"||addClass===null||addClass===false||addClass.substring(0,9)!="modal_cc_"){addClass=""}$.ajax({url:"/ajax/show-news?validity="+validity,success:function(result){if(result!=""){eModal.alert({message:result,size:"lg",title:title,subtitle:subtitle,buttons:[],addClass:addClass})}}})}function loadContent(href,selector,show_success_message){if(typeof show_success_message=="undefined"){show_success_message=false}$(selector).prepend(loading_message);$(selector).load(href,function(response,status,xhr){$(".loading_message").remove();if(show_success_message){$(selector).prepend(success_message)}if(status=="error"){alert(_("Eroare la actualizare (%1), incercati din nou in cateva secunde",status+": "+xhr.status))}})}function getSelectedEnums(form_id){var enum_ids_str="";$("#"+form_id+" .main-enums select").each(function(){if($(this).attr("id").indexOf("req-")!=-1){var enum_id=parseInt($(this).val());if(enum_id){enum_ids_str+=(enum_ids_str.length>0?"&":"")+"enum_ids[]="+enum_id}}});return enum_ids_str}function stockAlert(pid,title,subtitle){if(typeof title=="undefined"){title=_("Alerta stoc")}if(typeof subtitle=="undefined"){subtitle=""}var enum_ids_str=getSelectedEnums("add_main_product_"+pid);constructModal("/alerta-stoc/"+pid+"/"+(enum_ids_str?"?"+enum_ids_str:""),title,subtitle,"",null,null)}function quickOrder(source,pid,title){if(typeof title=="undefined"){title=_("Comanda rapida")}var enum_ids_str=getSelectedEnums("add_main_product_"+pid);constructModal("/shopping/quick-order/?source="+source+"&product_id="+pid+(enum_ids_str?"&"+enum_ids_str:""),title,"","",null,null)}function addToCartFromStockInfo(arr,form_id,is_ajax){var json=$.parseJSON(arr);var enums_arr=[];$(json).each(function(idx,val){enums_arr[idx]=val});$("#"+form_id+" .main-enums select").each(function(){if($(this).attr("name").indexOf("req-")!=-1){$(this).children().each(function(){var cid=parseInt($(this).attr("value"));var old_val=$(this).parent().val();if(!isNaN(cid)&&cid!=""&&cid!=old_val&&$.inArray(cid,enums_arr)!=-1){$(this).parent().val(cid).change();return}})}});$("#"+form_id+" .form-group").find(".form-control-feedback").remove();$("#"+form_id+" .form-group").removeClass("has-error").addClass("has-success").addClass("has-feedback");$("#"+form_id+" .form-group").append('<span class="form-control-feedback select" aria-hidden="true"><i class="fa fa-check"></i></span>')}function toggleWishlist($obj,product_id,listing_variant){if(typeof listing_variant=="undefined"){listing_variant=""}$($obj).addClass("loading");$.ajax({url:"/wishlist/quick-add/"+product_id+(listing_variant?"/?gchars[]="+listing_variant:""),success:function(result){if(isID("wishlist-content-wrapper")){$("#wishlist-content-wrapper").load("/ajax/wishlist-products/")}if(result=="added"){$($obj).prop("title",_("Sterge din favorite")).attr("data-original-title",_("Sterge din favorite")).tooltip({container:"body"}).tooltip("hide");$($obj).addClass("selected");$(".wishlist-button").removeClass(bs4?"d-none":"hidden")}else if(result=="deleted"){$($obj).prop("title",_("Adauga in favorite")).attr("data-original-title",_("Adauga in favorite")).tooltip({container:"body"}).tooltip("hide");$($obj).removeClass("selected")}else{alert(result)}if($(".wishlist-badge").length){$(".wishlist-badge").each(function(){var whishlist_cnt=parseInt($(this).text());$(this).text("");if(result=="added"){$(this).removeClass(bs4?"d-none":"hidden");$(this).text(whishlist_cnt+1)}else if(result=="deleted"){$(this).text(whishlist_cnt-1);if(whishlist_cnt==1){$(this).addClass(bs4?"d-none":"hidden")}}})}$($obj).removeClass("loading").blur()},error:function(xhr,err){alert(_("Eroare la adaugarea in wishlist (%1), incercati din nou in cateva secunde",err+": "+xhr.status))}})}function getSelectedGchars(form_id){let gchars=[];$("#"+form_id+" .main-enums select").each(function(){if($(this).attr("name").indexOf("req-")!=-1){let selected=$(this).find("option:selected");if(selected){gchars.push({id:selected.val(),name:selected.text()})}}});return gchars}function checkChosenProperties(form_id,is_ajax,do_submit,callback_func){if(typeof form_id=="undefined"||!isID(form_id)){alert(_("Parametri incorecti"));return false}if(typeof is_ajax=="undefined"){is_ajax=false}if(typeof do_submit=="undefined"){do_submit=true}if(isID("bought_voucher_email")){var msg=checkValid("bought_voucher_email",_("Adresa de email pentru destinatarul voucherului nu este valida"),"email");if(msg!=""){alert(msg);return false}}var has_error=false;if(bs4){var main_enums_select_length=$("#"+form_id+" .main-enums select").length}else{var main_enums_select_length=$("#"+form_id+" .main-enums select").size()}if(main_enums_select_length>0){$("#"+form_id+" .main-enums select").each(function(){if($(this).attr("name").indexOf("req-")!=-1){$(this).parents(".form-group.gchars-group").removeClass("has-error").removeClass("has-success").removeClass("has-feedback").find(".form-control-feedback").remove();var req_checkbox=$(this).data("reqid-checked");if(req_checkbox&&req_checkbox.length>0&&!$("#"+req_checkbox).is(":checked")){}else if(!$(this).val()){has_error=true;$(this).parents(".form-group.gchars-group").addClass("has-error").addClass("has-feedback").append('<span class="form-control-feedback select" aria-hidden="true"><i class="fa fa-times"></i></span>')}}})}if(has_error){$("#"+form_id+" .main-enums").removeClass(bs4?"d-none":"hidden");if(form_id.indexOf("add_main_product_")!==-1&&isID("scroll_to_main_enums")){if(isID("addtocart_button_wrapper")&&$("#addtocart_button_wrapper").hasClass("fixed")){scrollToElement(".main-enums",110)}else{scrollToElement(".main-enums",60)}}setTimeout(function(){alert(_("Te rugam sa alegi variantele dorite ale produsului"))},10);return false}else{if(is_ajax){$("#addtocart_button").addClass("loading");$("#addtocart_button").attr("disabled",true);$("#"+form_id).find(".addtocart-button").addClass("loading");$("#"+form_id).ajaxSubmit({timeout:5e4,success:function(result){if(!$("#"+form_id).hasClass("addtocart-modal")){animateImgToCart(form_id)}var productID=form_id.match(/\d+/g).map(Number);if(productID>0&&result.indexOf("has_cart_alert")==-1&&$("#"+form_id).hasClass("addtocart-modal")){constructModal("/ajax/product-added?pid="+productID,_("Produsul a fost adaugat cu succes!"),"",null,600,"modal_cc_added")}$("#addtocart_button").removeClass("loading");$("#addtocart_button").attr("disabled",false);$("#"+form_id).find(".addtocart-button").removeClass("loading");$("#"+form_id+" .form-group").removeClass("has-error").removeClass("has-success").removeClass("has-feedback").find(".form-control-feedback").remove();putCartHtml(result);$("#"+form_id+" .addtocart_result").removeClass(bs4?"d-none":"hidden");if(typeof callback_func=="function"){callback_func()}},error:function(xhr,err){$("#addtocart_button").removeClass("loading");$("#addtocart_button").attr("disabled",false);$("#"+form_id+" .form-group").removeClass("has-error").removeClass("has-success").removeClass("has-feedback").find(".form-control-feedback").remove();alert(_("Eroare la adaugarea in cos (%1), incercati din nou in cateva secunde",err+": "+xhr.status))}});return false}else{if(typeof callback_func=="function"){callback_func()}if(do_submit){$("#"+form_id).submit()}else{return true}}}}function putCartHtml(content){$("#cart-content-wrapper").html(content);$('[data-target="#cart-content-wrapper"]').each(function(){$(this).data("bs.popover").setContent(getPopoverContent("#cart-content-wrapper"));var $target_placement=$(this).attr("data-placement");$(".popover").addClass($target_placement+" fade in");var popCount=0;$('[data-target="#cart-content-wrapper"]').click(function(){if(popCount==1){$(".popover").popover("hide")}popCount++});$(".popover-title .close").click(function(){$(".popover").popover("hide")})});if($(".cart-count-withtext").length){if($("#cart-content-wrapper #cart-products-count").val()==1){$(".cart-count-withtext").html(_("%1 produs",$("#cart-content-wrapper #cart-products-count").val())+" - "+$("#cart-content-wrapper #cart-products-value").val());if(isID("fixed-count")){$("#fixed-count span").addClass("badge badge-up").html($("#cart-content-wrapper #cart-products-count").val())}}else{$(".cart-count-withtext").html(_("%1 produse",$("#cart-content-wrapper #cart-products-count").val())+" - "+$("#cart-content-wrapper #cart-products-value").val());if(isID("fixed-count")){$("#fixed-count span").addClass("badge badge-up").html($("#cart-content-wrapper #cart-products-count").val())}}}if($(".cart-count").length){$(".cart-value").html($("#cart-content-wrapper #cart-products-value").val());$(".cart-count").html($("#cart-content-wrapper #cart-products-count").val())}}function updateHeaderCart(){$("#header-cart-form").ajaxSubmit({success:function(result){putCartHtml(result)},error:function(){alert(_("Eroare la incarcare. Reincarcati pagina"))}});return false}function animateImgToCart(form_id){if(isID(form_id)){if(isID("gallery-carousel")&&isID("navbar-cart")){var $img=$("#gallery-carousel .carousel-inner div.active img")}else if(isID("navbar-cart")){var $img=$("#"+form_id+" img")}if(current_state=="xs"){var $cart_header=$('*[data-target="#cart-content-wrapper"]')}else{var $cart_header=$("#navbar-cart")}var dest_position=$cart_header.offset();var $img_position=$img.offset();if(dest_position!==null){var positionL=dest_position.left;var positionT=dest_position.top-$(window).scrollTop();var $clonedImg=$img.clone().appendTo("body");$($clonedImg).css("position","fixed");$($clonedImg).css("top",$img_position.top-$(window).scrollTop());$($clonedImg).css("left",$img_position.left);$($clonedImg).css("z-index","9999");$($clonedImg).animate({left:positionL,top:positionT,width:50,height:50},1e3,function(){$($clonedImg).remove()})}}}function cancelOrder(){msg=checkValid("cancel_reason",_("Completati motivul anularii comenzii."),"required");if(msg!=""){alert(msg);return false}else{$("#cancel_order").submit()}}function likeComment(comment_id){$.ajax({type:"POST",url:"/ajax/etc/product-coment-vote",data:{action:"like",comment_id:comment_id},success:function(msg){var result=JSON.parse(msg);if(typeof result.error=="undefined"){alert(_("Eroare la salvarea comentariului"))}else if(result.error==""){$("#comment-like-"+comment_id).addClass("liked");$("#comment-like-"+comment_id+" span.cnt").html(result.cnt)}else{alert(result.error)}},error:function(xhr,err){alert(_("Eroare la salvarea comentariului (%1), incercati din nou in cateva secunde",err+": "+xhr.status))}})}function submitProductRating(product_id){$("#name_"+product_id).val($("#customer_name").val());$("#email_"+product_id).val($("#customer_email").val());$("#form_"+product_id+" .fa-spin").removeClass(bs4?"d-none":"hidden");$("#form_"+product_id).ajaxSubmit({success:function(msg){if(msg=="ok"){$("#form_"+product_id+" .form-inputs").addClass(bs4?"d-none":"hidden");$("#form_"+product_id+" .send-comment").addClass(bs4?"d-none":"hidden");$("#form_"+product_id+" .comment-success").removeClass(bs4?"d-none":"hidden");$("#form_"+product_id+" .add-photo").addClass(bs4?"d-none":"hidden")}else{alert(msg)}},error:function(xhr,err){alert(_("Eroare la salvarea datelor (%1), incercati din nou in cateva secunde",err+": "+xhr.status))}});$("#form_"+product_id+" .fa-spin").addClass(bs4?"d-none":"hidden");return false}function submitAddProductPhoto(){msg=checkValid("cfoto_nickname",_("Completati pseudonimul"),"required");msg+=checkValid("cfoto_email",_("Completati adresa de email"),"required");msg+=checkValid("cfoto_foto",_("Alegeti o fotografie"),"required");if($("#cfoto_email").val()!=""){msg+=checkValid("cfoto_email",_("Adresa de email introdusa nu este valida"),"email")}msg+=checkValid("cfoto_agree",_("Trebuie sa confirmati varsta dvs. si ca fotografia incarcata va apartine"),"checkbox");if(msg!=""){alert(msg);return false}else{return true}}function toggleCompareProduct(pid,catid,cwhich){$(cwhich).addClass("loading");$.ajax({url:"/ajax/compare_products?toggle_product="+pid+"&state="+current_state,success:function(result){$(cwhich).removeClass("loading").blur();if(result==-1){alert(_("Numarul maxim de produse pentru comparatie a fost depasit"))}else if(result==0){$(cwhich).prop("title",_("Adauga in lista de comparatie")).attr("data-original-title",_("Adauga in lista de comparatie")).tooltip({container:"body"}).tooltip("hide");$(cwhich).removeClass("selected")}else{$(cwhich).prop("title",_("Sterge din lista de comparatie")).attr("data-original-title",_("Sterge din lista de comparatie")).tooltip({container:"body"}).tooltip("hide");$(cwhich).addClass("selected")}showCompareProducts(catid)},error:function(xhr,err){alert(_("Eroare la adaugarea in lista de comparatie (%1), incercati din nou in cateva secunde",err+": "+xhr.status))}})}function showCompareProducts(catid){$.ajax({url:"/ajax/compare_products?category_id="+catid,success:function(result){$("#compare_products_container").html(result);if(result!=""){$("#compare_products_container").removeClass(bs4?"d-none":"hidden")}else{$("#compare_products_container").addClass(bs4?"d-none":"hidden")}},error:function(xhr,err){alert(_("Eroare la adaugarea in lista de comparatie (%1), incercati din nou in cateva secunde",err+": "+xhr.status))}})}function openCompareProducts(pids){constructModal("/compara/"+pids,_("Compara produse"),null,"","full")}$.fn.removeClassRegex=function(regex){return this.removeClass(function(index,classes){return classes.split(/\s+/).filter(function(c){return regex.test(c)}).join(" ")})};function collapseComments(element){if($(element).hasClass("collapsed")){if($(element).attr("data-toggle-text-off")&&$(element).attr("data-toggle-text-on")){$(element).text($(element).data("toggle-text-off"))}}else{if($(element).attr("data-toggle-text-off")&&$(element).attr("data-toggle-text-on")){$(element).text($(element).data("toggle-text-on"))}scrollToElement(".comments blockquote:first")}$(element).blur()}function addUrlParam(url,param){var hash_index=url.indexOf("#");var hash="";if(hash_index!==-1){hash=url.substring(hash_index);url=url.substring(0,hash_index)}if(url&&url.indexOf(param)!==-1){return url}if(url&&url.indexOf("?")!==-1){var sep="&"}else{var sep="?"}return url+sep+param+hash}function ajaxListProducts(target_id,pids,title,perslide,overwrite_pids_url){if(typeof title=="undefined"||title===null){title=""}if(typeof perslide=="undefined"||perslide===null){perslide=""}if(typeof overwrite_pids_url=="undefined"){overwrite_pids_url=false}if(isID(target_id)){$("#"+target_id).load("/ajax/list-products?"+(overwrite_pids_url?pids:"pids="+pids)+"&title="+encodeURIComponent(title)+"&perslide="+perslide)}}function doCategorySearch(e){var search=$("#catq").val();if(!e&&window.event){e=window.event}if(typeof e.which=="number"){e=e.which}else if(typeof e.keyCode=="number"){e=e.keyCode}else if(typeof e.charCode=="number"){e=e.charCode}if(e==13||e==1){if(search.length>0){url=$("#noq_url").val()+$("#q_token").val()+encodeURIComponent(search).replace(/%20/g,"+")+"/"}else{url=$("#resetq_url").val()}window.location=url}}function precheckAddToCart(selector,pid,use_ajax){if(typeof pid=="undefined"||pid===null){pid=null}else{pid=parseInt(pid)}if(typeof use_ajax=="undefined"||use_ajax===null){use_ajax=false}var enums_cnt=0;var selected_values=new Array;if($(selector+" select").length==0){return}if(use_ajax){if(!pid){return}$(selector+" select").each(function(){if($(this).attr("id").indexOf("req-")!=-1){enums_cnt++;var part_pid=$(this).data("part_pid");if(typeof part_pid=="undefined"||part_pid===null){part_pid=0}var sel_value=$(this).val();if(sel_value!=""){var pp_found=false;$.each(selected_values,function(index,value){if(value.part_pid==part_pid){value.gchars.push(sel_value)}});if(!pp_found){selected_values.push({part_pid:part_pid,gchars:[sel_value]})}}}});if(selected_values.length){var selected_values_str="";$.each(selected_values,function(index,value){selected_values_str+=(selected_values_str?",":"")+value.part_pid;if(value.gchars.length){selected_values_str+="_"+value.gchars.join("|")}});$.ajax({url:"/ajax/check-gchars?product_id="+pid+"&parts_gchars="+selected_values_str,success:function(result){if(IsValidJSONString(result)){result=JSON.parse(result);if(typeof result.availability!=="undefined"&&result.availability!==null){$("#product_availability").html("<span>"+result.availability+"</span>")}}}})}}else{$(selector+" select").each(function(){if($(this).attr("id").indexOf("req-")!=-1){enums_cnt++;var sel_value=$(this).val();if(sel_value!=""){selected_values.push(parseInt(sel_value))}}});var gchars_str=selected_values.sort(function(a,b){return a-b}).join("|");if(enums_cnt>0&&enums_cnt==selected_values.length){var gchars_str=selected_values.sort(function(a,b){return a-b}).join("|");var has_stock=$('[data-stock-info="'+gchars_str+'"]').length;var colIndex=$('[data-stock-info="'+gchars_str+'"]').index();$("th").removeClass("selected");$("td").removeClass("selected");$('[data-stock-info="'+gchars_str+'"]').closest("td").siblings(":first-child").addClass("selected");$('[data-stock-info="'+gchars_str+'"]').addClass("selected");$(".stock-variants th:eq("+colIndex+")").addClass("selected");if(has_stock){$(".product_offer").addClass("offer-instock").removeClass("offer-offstock")}else{$(".product_offer").removeClass("offer-instock").addClass("offer-offstock")}if(has_stock){var stock_availability=$('[data-stock-info="'+gchars_str+'"]').attr("data-stock-info-availability");var stock_class=$('[data-stock-info="'+gchars_str+'"]').attr("data-stock-info-class");if(typeof stock_availability!==typeof undefined&&stock_availability!==false){if(typeof stock_class!==typeof undefined&&stock_class!==false){$(".product_offer p.availability #product_availability").removeAttr("class");$(".product_offer p.availability #product_availability").addClass(stock_class)}$(".product_offer p.availability #product_availability").text(stock_availability)}}}else if($('[data-stock-info="product_availability"]').length){var stock_availability=$('[data-stock-info="product_availability"]').attr("data-stock-info-availability");var stock_class=$('[data-stock-info="'+gchars_str+'"]').attr("data-stock-info-class");if(typeof stock_availability!==typeof undefined&&stock_availability!==false){if(typeof stock_class!==typeof undefined&&stock_class!==false){$(".product_offer p.availability #product_availability").removeAttr("class");$(".product_offer p.availability #product_availability").addClass(stock_class)}$(".product_offer p.availability #product_availability").text(stock_availability)}}}}function switchDisplay(type){if(type=="list"){$("#products-list .item").addClass("list-group-item").removeClass("grid-group-item");if(bs4){$("#products-list").addClass("d-block").removeClass("row")}$("#display-list").addClass("active");$("#display-grid").removeClass("active")}else{$("#products-list .item").removeClass("list-group-item").addClass("grid-group-item");if(bs4){$("#products-list").addClass("row").removeClass("d-block")}$("#display-grid").addClass("active");$("#display-list").removeClass("active")}}function IsValidJSONString(str){try{JSON.parse(str)}catch(e){return false}return true}function loadCookiesDescription(target){if($(target+" .modal-body").html().trim()==""){$(target+" .modal-body").load("/ajax/etc/cookies-consent?show_description="+target.replace("#",""),function(response,status,xhr){if(status=="error"){alert(_("Eroare la actualizare (%1), incercati din nou in cateva secunde",status+": "+xhr.status))}})}}function initCookiesConsent(){if($("#cookie_settings").length){if(current_state=="xs"){$("#req, #prf, #sta, #mkt").on("shown.bs.modal",function(){loadCookiesDescription("#"+this.id)})}else{$("#cookie_settings .modal-trigger").each(function(){$(this).hoverIntent({interval:50,sensitivity:10,timeout:150,over:function(){let target=$(this).data("target");loadCookiesDescription(target);$("#cookie_settings .modal-trigger").removeClass("active");$("#cookie_settings .modals-container .modal").removeClass("active");$(this).addClass("active");$(target).addClass("active")},out:function(){}})})}}}function toggleAcceptCookies(){$(".accept-cookies").toggle();if(current_state=="xs"){$("#cookies-consent").toggleClass("expanded")}else{loadCookiesDescription("#req")}}function saveCookieConsent(type){$(".modal-backdrop, .cookie-consent-modal").hide();if(type=="custom"||type=="all"){$("#cookies_consent_type").val(type);if(type=="all"){$(".consent-checkbox").prop("checked",true)}let has_mkt=$('input[name="mkt"]:checked').length;let has_sta=$('input[name="sta"]:checked').length;if(typeof dataLayer!="undefined"&&typeof gtag!="undefined"){let gtm_consent={ad_user_data:has_sta?"granted":"denied",ad_personalization:has_mkt?"granted":"denied",ad_storage:has_mkt?"granted":"denied",analytics_storage:has_sta?"granted":"denied"};gtag("consent","update",gtm_consent);dataLayer.push({event:"consent_updated",consent:gtm_consent})}if(typeof fbq!="undefined"&&has_mkt){fbq("consent","grant")}$("#cookies_form").ajaxSubmit({success:function(msg){if(msg=="ok"){$("#cookies-consent").fadeOut(300,function(){$(this).remove()})}else{alert(msg)}},error:function(xhr,err){alert(_("Eroare la salvarea preferintelor (%1), incercati din nou in cateva secunde",err+": "+xhr.status))}})}else{alert(_("Optiune invalida: %s",type))}return false}function getCookiesArray(){var cookies={};if(document.cookie&&document.cookie!=""){var split=document.cookie.split(";");for(var i=0;i<split.length;i++){var name_value=split[i].split("=");name_value[0]=name_value[0].replace(/^ /,"");cookies[decodeURIComponent(name_value[0])]=decodeURIComponent(name_value[1])}}return cookies}function isNumberKey(event){var charCode=event.which?event.which:event.keyCode;if(charCode>31&&(charCode<48||charCode>57)){return false}return true}function initDarkMode(){$(".switcher").click(function(){if($("body").hasClass("dark-mode")){DarkModeOff();setCookie("themeMode","light",30)}else{DarkModeOn();setCookie("themeMode","dark",30)}})}function DarkModeOn(){$("body").addClass("dark-mode");$(".switcher a").prop("title",_("Dezactiveaza Dark Mode"));var logoElement=current_state!="xs"?$(".logo .img-detect-mode"):$(".logo-mobile .img-detect-mode");logoElement.attr("src",logoElement.attr("data-src-dark"));$(".switcher").find("i.fa").removeClass("fa-moon").addClass("fa-sun")}function DarkModeOff(){$("body").removeClass("dark-mode");$(".switcher a").prop("title",_("Activeaza Dark Mode"));var logoElement=current_state!="xs"?$(".logo .img-detect-mode"):$(".logo-mobile .img-detect-mode");logoElement.attr("src",logoElement.attr("data-src-light"));$(".switcher").find("i.fa").removeClass("fa-sun").addClass("fa-moon")}function initMegaMenu(){if(!is_touch&&current_state!="xs"&&current_state!="sm"){$("#main-navbar .navbar-nav").hoverIntent({interval:10,sensitivity:10,timeout:100,over:function(){$(this).addClass("show")},out:function(){$(this).removeClass("show")}});$(window).scroll(function(){if($(window).scrollTop()>100){$(".scroll-top").fadeIn(200);$("#top-nav").addClass("fixed");$(".logo-d").addClass("px-2")}else{$(".scroll-top").fadeOut(200);$("#top-nav").removeClass("fixed");$(".logo-d").removeClass("px-2")}});$(".scroll-top").click(function(event){event.preventDefault();$("html, body").animate({scrollTop:0},"slow");return false});$(".dropdown[data-trigger='hover']").hoverIntent({interval:50,sensitivity:10,timeout:150,over:function(){if($(this).data("effect")&&$(this).data("effect")=="fadeToggle"){$(this).find(".dropdown-menu").first().stop(true,true).fadeIn(200)}else if($(this).data("effect")&&$(this).data("effect")=="slideToggle"){$(this).find(".dropdown-menu").first().stop(true,true).slideDown(300)}},out:function(){if($(this).data("effect")&&$(this).data("effect")=="fadeToggle"){$(this).find(".dropdown-menu").first().stop(true,true).fadeOut(200)}else if($(this).data("effect")&&$(this).data("effect")=="slideToggle"){$(this).find(".dropdown-menu").first().stop(true,true).slideUp(300)}}})}if(current_state=="xs"||current_state=="sm"){$("#nav-switch-mega #menu").addClass("dropdown-menu")}else{$("#nav-switch-mega #menu").removeClass("dropdown-menu")}$("#nav-switch-mega a.dropdown-toggle").on("click",function(e){if(current_state=="xs"||current_state=="sm"){var $subMenu=$(this).next(".dropdown-menu");$subMenu.toggleClass("show");return false}});$(".rotate").click(function(){$(this).toggleClass("down")})}function initMenuTop(){if(isID("navbar-categories")&&!is_touch&&current_state!="xs"&&current_state!="sm"){var targetOffset=$("#navbar-categories").offset().top;$(window).scroll(function(){if($(window).scrollTop()>=targetOffset){$("#navbar-categories").addClass("fixed");$("#navbar-categories").addClass("animate");$("#header-content").addClass("pb-5")}else{$("#navbar-categories").removeClass("fixed");$("#navbar-categories").removeClass("animate");$("#header-content").removeClass("pb-5")}})}}function selectPaymentToken(payment_method){if(isID("save_payment_token_"+payment_method+"_container")){if($('input[name="payment_token_'+payment_method+'"]:checked').length>0&&$('input[name="payment_token_'+payment_method+'"]:checked').val()!=-1){$("#save_payment_token_"+payment_method+"_container").addClass(bs4?"d-none":"hidden")}else{$("#save_payment_token_"+payment_method+"_container").removeClass(bs4?"d-none":"hidden")}}}function RMASelectRow(id){if($("#pid_"+id).prop("checked")){$("#row_"+id).removeClass(bs4?"d-none":"hidden")}else{$("#row_"+id).addClass(bs4?"d-none":"hidden")}}function lazyloadImages(){if($(".lazy").length){$(".lazy").Lazy({effect:"fadeIn",effectTime:200,onError:function(element){console.log("error loading "+element.data("src"))}})}}function ajaxPagination(url){$("#next_pages").attr("id","next_pages_loading");$("#next_pages_loading").html(loading_message);$("#next_pages").remove();$.ajax({url:addUrlParam(url,"is_ajax=1"),success:function(result){$("#next_pages_loading").remove();$("#products-list").append(result)},error:function(xhr,err){alert(_("Eroare la incarcarea produselor (%1), incercati din nou in cateva secunde",err+": "+xhr.status))}});history.replaceState("","",url)}function toggleBackendOption(action,item_type,item_id,value){$.ajax({url:"/ajax/backend-tools?action="+action+"&type="+item_type+"&id="+item_id+"&value="+value,success:function(result){if(result=="OK"){if(value===true){$(".bkt-label-"+item_id).addClass("label-danger");$(".bkt-chk-"+item_id).prop("checked",true)}else if(value===false){$(".bkt-label-"+item_id).removeClass("label-danger");$(".bkt-chk-"+item_id).prop("checked",false)}return true}else{alert(result);return false}}})}function minusOne($obj){var initialVal=parseInt($($obj).parent().find("input").val());if(initialVal>1){$($obj).parent().find("input").val(initialVal-1).change()}else{alert(_("Minim %1 bucata!",1))}}function plusOne($obj,maxVal){var initialVal=parseInt($($obj).parent().find("input").val());if(typeof maxVal!="undefined"&&initialVal>=maxVal){alert(_("Maxim %1 bucati!",maxVal))}else{$($obj).parent().find("input").val(initialVal+1).change()}}function switchPriceGchar(price,currency){let global_discount=0;if(isID("price_container")&&isID("product_gchars")){$("#product_gchars select").each(function(){if($(this).attr("id").indexOf("req-")!=-1){let enum_id=$(this).val();if(typeof chPrices[enum_id]!="undefined"){let cprice=Math.abs(parseFloat(chPrices[enum_id]["price"]));if(chPrices[enum_id]["currency"]=="prc"){switch(chPrices[enum_id]["pricetype"]){case"fixed":break;case"add":global_discount=global_discount+cprice;break;case"substract":global_discount=global_discount-cprice;break}}else{switch(chPrices[enum_id]["pricetype"]){case"fixed":price=cprice;break;case"add":price=price+cprice;break;case"substract":price=price-cprice;break}}}}});if(global_discount){if(global_discount<0){price=Math.round(price*(1-Math.abs(global_discount)/100)*100)/100}else{price=Math.round(price*(Math.abs(global_discount)/100+1)*100)/100}}price=price.toFixed(2);price=price.replace(".","<sup>,")+"</sup>";$("#price_container").html(price+" "+currency)}}$.fn.isInViewport=function(){var elementTop=$(this).offset().top;var elementBottom=elementTop+$(this).outerHeight();var viewportTop=$(window).scrollTop();var viewportBottom=viewportTop+$(window).innerHeight();return elementBottom>viewportTop&&elementTop<viewportBottom-$(this).height()};